<app-page-title title="Register"></app-page-title>
<main>
  <div class="mx-auto max-w-7xl py-6 sm:px-6 lg:px-8">

    <div class="w-full mx-auto max-w-md space-y-8">

      <!-- Login Form -->
      <form (ngSubmit)="registerHandler()" [formGroup]="regForm"
            class="bg-white dark:bg-gray-800 mt-8 space-y-5 shadow p-10 rounded-lg
            shadow-2xl dark:shadow dark:shadow-gray-500">

        <!-- Login Link -->
        <div class="mt-3 text-sm">
          <span>Already have an account? </span>
          <a routerLink="/login"
             [ngClass]="classes.link">Login here.</a>
        </div>

        <!-- First name Input Container-->
        <div>
          <label class="text-sm">First name: <span class="text-rose-500">*</span></label>
          <div class="flex align-center border border-slate-600 rounded"
               [ngClass]="{ 'ok-input': (regForm.get('firstName')?.touched && !regForm.get('firstName')?.errors),
               'error-input': (regForm.get('firstName')?.touched && regForm.get('firstName')?.errors) }">

            <span [ngClass]="classes.inputIcon">
              <mat-icon>person</mat-icon>
            </span>

            <input [ngClass]="classes.input"
                   type="text"
                   autocomplete="off"
                   placeholder="Firstname"
                   pattern="^[A-Z][a-z]{1,45}$"
                   formControlName="firstName"
                   required
            />
          </div>
          <!-- Error/OK messages -->
          <ng-container *ngIf="regForm.get('firstName')?.touched">
            <span *ngIf="regForm.get('firstName')?.errors?.['required']"
                  class="text-sm text-red-600">
              Please enter Username!
            </span>
            <span *ngIf="regForm.get('firstName')?.errors?.['pattern']"
                  class="text-sm text-red-600">
              First name must Start with capital letter and contains only letters between 2 - 45 characters (No Whitespace!)!
            </span>
            <span class="text-sm text-green-600" *ngIf="!regForm.get('firstName')?.errors">Looks OK!</span>
          </ng-container>

        </div>

        <!-- Email Input Container-->
        <div>
          <label class="text-sm">Email: <span class="text-rose-500">*</span></label>
          <div class="flex align-center border border-slate-600 rounded"
               [ngClass]="{ 'ok-input': (regForm.get('email')?.touched && !regForm.get('email')?.errors),
               'error-input': (regForm.get('email')?.touched && regForm.get('email')?.errors) }">

            <span [ngClass]="classes.inputIcon">
              <mat-icon>mail</mat-icon>
            </span>

            <input [ngClass]="classes.input"
                   type="text"
                   autocomplete="off"
                   placeholder="Email"
                   pattern="^([a-z]+)\w{2,}[@][a-z_-]{3,45}[.][a-z]{2,5}$"
                   formControlName="email"
                   required
            />
          </div>
          <!-- Error/OK messages -->
          <ng-container *ngIf="regForm.get('email')?.touched">
            <span *ngIf="regForm.get('email')?.errors?.['required']"
                  class="text-sm text-red-600">
              Please enter Email!
            </span>
            <span *ngIf="regForm.get('email')?.errors?.['pattern']"
                  class="text-sm text-red-600">
              Please, enter valid Email!
            </span>
            <span class="text-sm text-green-600" *ngIf="!regForm.get('email')?.errors">Looks OK!</span>
          </ng-container>

        </div>


        <ng-container formGroupName="pass">

          <!-- Password Input Container-->
          <div>
            <label class="tex-sm">Password: <span class="text-rose-500">*</span></label>
            <div class="flex align-center border border-slate-600 rounded"
                 [ngClass]="{ 'ok-input': (regForm.get('pass')?.get('password')?.touched && !regForm.get('pass')?.get('password')?.errors),
               'error-input': (regForm.get('pass')?.get('password')?.touched && regForm.get('pass')?.get('password')?.errors) }">

              <span [ngClass]="classes.inputIcon">
                <mat-icon>lock</mat-icon>
              </span>

              <input [ngClass]="classes.input"
                     type="password"
                     autocomplete="off"
                     placeholder="Password"
                     formControlName="password"
                     required
              />
            </div>
            <!-- Error/OK messages -->
            <ng-container *ngIf="regForm.get('pass')?.get('password')?.touched">
            <span *ngIf="regForm.get('pass')?.get('password')?.errors?.['required']"
                  class="text-sm text-red-600">
              Please enter Password!
            </span>
              <span *ngIf="regForm.get('pass')?.get('password')?.errors?.['minLength']"
                    class="text-sm text-red-600">
              Password must be at least 8 characters long!
            </span>
              <span class="text-sm text-green-600"
                    *ngIf="!regForm.get('pass')?.get('password')?.errors">Looks OK!</span>
            </ng-container>

          </div>

          <!-- Confirm password Input Container-->
          <div>
            <label class="tex-sm">Confirm password: <span class="text-rose-500">*</span></label>
            <div class="flex align-center border border-slate-600 rounded"
                 [ngClass]="{ 'ok-input': (regForm.get('pass')?.get('rePassword')?.touched
                 && !regForm.get('pass')?.get('rePassword')?.errors && !regForm.get('pass')?.errors),
               'error-input': (regForm.get('pass')?.get('rePassword')?.touched
                && regForm.get('pass')?.get('rePassword')?.errors) ||
                 (regForm.get('pass')?.get('rePassword')?.touched
                  && regForm.get('pass')?.errors)}">

              <span [ngClass]="classes.inputIcon">
                <mat-icon>lock</mat-icon>
              </span>

              <input [ngClass]="classes.input"
                     type="password"
                     autocomplete="off"
                     placeholder="Confirm password"
                     formControlName="rePassword"
                     required
              />
            </div>
            <!-- Error/OK messages -->
            <ng-container *ngIf="regForm.get('pass')?.get('password')?.touched">
            <span *ngIf="regForm.get('pass')?.get('rePassword')?.errors?.['required']"
                  class="text-sm text-red-600">
              Please enter Password!
            </span>
              <span *ngIf="regForm.get('pass')?.get('rePassword')?.errors?.['minLength']"
                    class="text-sm text-red-600">
              Password must be at least 8 characters long!
            </span>
              <span *ngIf="regForm.get('pass')?.errors?.['sameValueValidator']"
                    class="text-sm text-red-600 block">
              Password and Re-password doesn't match!
            </span>
              <span class="text-sm text-green-600"
                    *ngIf="(!regForm.get('pass')?.get('rePassword')?.errors
                    && !regForm.get('pass')?.errors)">Looks OK!</span>
            </ng-container>

          </div>

        </ng-container>


        <!-- Register Button -->
        <div>

          <button class="w-full relative" [disabled]="regForm.invalid" type="submit"
                  [class]="regForm.invalid
                  ? 'btn-primary-disabled dark:btn-primary-disabled-dark'
                  : 'btn-primary dark:btn-primary-dark'">
            <span class="absolute inset-y-0 left-0 flex items-center pl-3">
              <i class="fas fa-regular fa-user-plus"></i>
            </span>
            Register
          </button>

        </div>

        <hr>
        <!-- Join with Social Media -->
        <p class="text-center">Or sign up with your social network</p>
        <div class="flex justify-between gap-4">
          <button type="button" class="py-2 px-3 border hover:border-rose-600 w-full rounded">Google</button>
          <button type="button" class="py-2 px-3 border hover:border-blue-600 w-full rounded">Facebook</button>
        </div>

      </form>

      {{regForm.value | json}}
      <hr>
      Valid: {{regForm.valid | json}}
      Invalid: {{regForm.invalid | json}}

    </div>

  </div>
</main>
